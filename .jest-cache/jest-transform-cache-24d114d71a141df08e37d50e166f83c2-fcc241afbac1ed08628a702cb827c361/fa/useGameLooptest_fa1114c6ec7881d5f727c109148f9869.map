{"version":3,"names":["_reactHooks","require","_useGameLoop","_gameData","describe","beforeEach","jest","useFakeTimers","spyOn","window","mockImplementation","cb","setTimeout","afterEach","useRealTimers","requestAnimationFrame","mockRestore","mockProps","gameStarted","gameOver","gameCompleted","tilesSpawned","endlessMode","activePowerUps","slowMotion","active","invincible","happyBirthdayNotes","onSpawnTile","fn","onUpdateTiles","onUpdatePowerUps","onSpawnPowerUp","onLoseLife","onGameOver","it","result","renderHook","useGameLoop","act","current","startGameLoop","advanceTimersByTime","GAME_CONFIG","BASE_SPAWN_INTERVAL","expect","toHaveBeenCalled","propsWithPowerUps","spawnedTile","mock","calls","speed","toBeLessThan","BASE_TILE_SPEED","unmount","not","endlessModeProps","noteIndex","toBe","length","gameOverProps"],"sources":["useGameLoop.test.js"],"sourcesContent":["import { renderHook, act } from '@testing-library/react-hooks';\r\nimport { useGameLoop } from '../hooks/useGameLoop';\r\nimport { GAME_CONFIG } from '../constants/gameData';\r\n\r\ndescribe('useGameLoop', () => {\r\n  beforeEach(() => {\r\n    jest.useFakeTimers();\r\n    jest.spyOn(window, 'requestAnimationFrame').mockImplementation(cb => setTimeout(cb, 16));\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.useRealTimers();\r\n    window.requestAnimationFrame.mockRestore();\r\n  });\r\n\r\n  const mockProps = {\r\n    gameStarted: true,\r\n    gameOver: false,\r\n    gameCompleted: false,\r\n    tilesSpawned: 0,\r\n    endlessMode: false,\r\n    activePowerUps: {\r\n      slowMotion: { active: false },\r\n      invincible: { active: false }\r\n    },\r\n    happyBirthdayNotes: ['C4', 'D4', 'E4'],\r\n    onSpawnTile: jest.fn(),\r\n    onUpdateTiles: jest.fn(),\r\n    onUpdatePowerUps: jest.fn(),\r\n    onSpawnPowerUp: jest.fn(),\r\n    onLoseLife: jest.fn(),\r\n    onGameOver: jest.fn()\r\n  };\r\n\r\n  it('should start game loop when game starts', () => {\r\n    const { result } = renderHook(() => useGameLoop(mockProps));\r\n    \r\n    act(() => {\r\n      result.current.startGameLoop();\r\n      jest.advanceTimersByTime(GAME_CONFIG.BASE_SPAWN_INTERVAL);\r\n    });\r\n\r\n    expect(mockProps.onSpawnTile).toHaveBeenCalled();\r\n    expect(mockProps.onUpdateTiles).toHaveBeenCalled();\r\n  });\r\n\r\n  it('should handle power-ups correctly', () => {\r\n    const propsWithPowerUps = {\r\n      ...mockProps,\r\n      activePowerUps: {\r\n        slowMotion: { active: true },\r\n        invincible: { active: true }\r\n      }\r\n    };\r\n\r\n    const { result } = renderHook(() => useGameLoop(propsWithPowerUps));\r\n    \r\n    act(() => {\r\n      result.current.startGameLoop();\r\n      jest.advanceTimersByTime(2500); // Slow motion interval\r\n    });\r\n\r\n    expect(mockProps.onSpawnTile).toHaveBeenCalled();\r\n    const spawnedTile = mockProps.onSpawnTile.mock.calls[0][0];\r\n    expect(spawnedTile.speed).toBeLessThan(GAME_CONFIG.BASE_TILE_SPEED);\r\n  });\r\n\r\n  it('should stop game loop on cleanup', () => {\r\n    const { result, unmount } = renderHook(() => useGameLoop(mockProps));\r\n    \r\n    act(() => {\r\n      result.current.startGameLoop();\r\n    });\r\n\r\n    unmount();\r\n    expect(window.requestAnimationFrame).not.toHaveBeenCalled();\r\n  });\r\n\r\n  it('should handle endless mode correctly', () => {\r\n    const endlessModeProps = {\r\n      ...mockProps,\r\n      endlessMode: true,\r\n      tilesSpawned: 5\r\n    };\r\n\r\n    const { result } = renderHook(() => useGameLoop(endlessModeProps));\r\n    \r\n    act(() => {\r\n      result.current.startGameLoop();\r\n      jest.advanceTimersByTime(GAME_CONFIG.BASE_SPAWN_INTERVAL);\r\n    });\r\n\r\n    expect(mockProps.onSpawnTile).toHaveBeenCalled();\r\n    const spawnedTile = mockProps.onSpawnTile.mock.calls[0][0];\r\n    expect(spawnedTile.noteIndex).toBe(5 % mockProps.happyBirthdayNotes.length);\r\n  });\r\n\r\n  it('should handle game over', () => {\r\n    const gameOverProps = {\r\n      ...mockProps,\r\n      gameOver: true\r\n    };\r\n\r\n    renderHook(() => useGameLoop(gameOverProps));\r\n    expect(mockProps.onGameOver).toHaveBeenCalled();\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}